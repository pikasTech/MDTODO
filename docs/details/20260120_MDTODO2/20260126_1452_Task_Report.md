# R55.1 任务报告：编辑任务后保持展开/折叠状态

## 问题描述
编辑完一个顶级任务之后，会导致子任务自动展开，无法保持原来的展开/折叠状态。

## 根本原因
在 `src/webview/components/TaskList.tsx` 的 `handleRefreshTaskTitle` 函数中（第 176 行），存在以下代码：

```typescript
// 确保任务展开
setExpandedTasks((prev) => new Set(prev).add(taskId));
```

这行代码的本意是确保正在编辑的任务可见，但它在刷新任务标题时会**强制展开被编辑的任务**，破坏了用户原来的展开/折叠状态。

## 解决方案
删除 `handleRefreshTaskTitle` 函数中的 `setExpandedTasks` 调用。

编辑任务后不应该改变任务的展开/折叠状态，这个行为应该完全由用户控制。

## 修改文件
- `src/webview/components/TaskList.tsx`: 删除第 175-176 行的 `setExpandedTasks` 调用

## 修改内容
```diff
-    });
-    // 确保任务展开
-    setExpandedTasks((prev) => new Set(prev).add(taskId));
-    // 清除该任务的编辑状态（刷新标题意味着完成编辑）
+    });
+    // 清除该任务的编辑状态（刷新标题意味着完成编辑）
```

## 验证
编译通过，修改后编辑任务将保持原有的展开/折叠状态。

## 执行时间
2026-01-26
