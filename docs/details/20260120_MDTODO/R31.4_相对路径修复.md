# R31.4 相对路径修复执行记录

## 任务描述

连接里面必须要`(./xxx/)`开头才能打开，`(xxx/)`开头就打不开，这两个应该是等价的才对。

## 问题分析

在 `webviewProvider.ts` 的 `handleOpenLink` 方法中，原来的路径判断逻辑为：

```typescript
if (decodedUrl.startsWith('./') || decodedUrl.startsWith('../')) {
```

这意味着只有以 `./` 或 `../` 开头的路径才会被识别为相对路径并基于当前文件目录解析。而 `(xxx/)` 开头的路径无法匹配这个条件，被当作绝对路径处理，导致无法正确打开文档。

## 解决方案

修改路径判断逻辑，使用更通用的相对路径识别方式：

```typescript
// 【修复R31.4】支持不带 ./ 前缀的相对路径，如 (xxx/) 或 (docs/file.md)
// 相对路径不以 / 开头（Unix绝对路径），也不包含盘符（Windows绝对路径）
const isRelativePath = !decodedUrl.startsWith('/') && !decodedUrl.match(/^[A-Za-z]:/);
```

这样可以正确识别以下类型的相对路径：
- `./docs/file.md` - 带 `./` 的相对路径
- `docs/file.md` - 不带 `./` 的相对路径
- `xxx/` - 相对路径（当前目录下的子目录）

而不匹配：
- `/absolute/path` - Unix 绝对路径
- `C:/path` - Windows 盘符路径
- `\\server\share` - 网络路径

## 修改文件

- `vscode-mdtodo/src/providers/webviewProvider.ts:478-480`

## 验证方法

1. 在任务内容中添加链接 `[链接文本](xxx/file.md)`（不带 `./`）
2. 点击链接，应能在 VSCode 中打开对应文档
3. 对比 `[链接文本](./xxx/file.md)`（带 `./`）的行为，两者应一致
