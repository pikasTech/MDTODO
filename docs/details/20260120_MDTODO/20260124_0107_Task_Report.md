# R51.5.8 任务报告：取消浮动栏，筛选做成下拉菜单到标题栏

## 任务目标

1. 取消浮动筛选栏组件
2. 将筛选功能改为下拉菜单形式，放到标题栏中

## 执行步骤

### 1. 删除 FloatingFilterBar 组件

删除了 `src/webview/components/FloatingFilterBar.tsx` 文件，该组件之前负责渲染浮动筛选栏。

### 2. 更新 TaskList.tsx

修改了 `src/webview/components/TaskList.tsx`：

- **移除了 FloatingFilterBar 的导入**
- **移除了相关状态变量**：
  - `filterBarVisible` - 浮动栏展开状态
  - `headerHeight` - 标题栏高度（用于定位浮动栏）
  - `headerRef` - 标题栏 DOM 引用
- **移除了相关函数**：
  - `handleHeaderMouseEnter` - 鼠标进入标题栏事件
  - `handleFilterBarMouseLeave` - 鼠标离开浮动栏事件
  - `updateHeaderHeight` - 更新标题栏高度函数
- **移除了相关 useEffect** - 监听窗口大小变化获取标题栏高度

### 3. 在标题栏添加筛选下拉菜单

在标题栏的工具栏区域（header-actions）添加了：

- **筛选下拉菜单** (`filter-dropdown`)：
  - 包含4个选项：全部、隐藏完成、未开始、进行中
  - 与跳转下拉菜单保持一致的风格
  - 支持点击切换筛选类型

- **清除筛选按钮**：
  - 仅在有激活的筛选条件时显示（`filterType !== 'all'`）
  - 点击后清除筛选条件，恢复显示全部任务

### 4. 更新 CSS 样式

修改了 `src/webview/bundle.css`：

- 添加了 `.filter-dropdown` 样式，与跳转下拉菜单风格一致
- 添加了 `.clear-filter-btn.toolbar-icon-btn` 样式，使清除按钮与工具栏按钮风格统一

## 验证结果

- 编译成功，无错误
- 筛选功能正常工作
- 浮动栏已被移除，不再占用额外空间
- 筛选下拉菜单在标题栏中显示，紧凑美观

## 文件变更

| 文件 | 变更类型 | 说明 |
|------|----------|------|
| `src/webview/components/FloatingFilterBar.tsx` | 删除 | 移除浮动筛选栏组件 |
| `src/webview/components/TaskList.tsx` | 修改 | 移除浮动栏逻辑，添加筛选下拉菜单 |
| `src/webview/bundle.css` | 修改 | 添加筛选下拉菜单和清除按钮样式 |
