# R17.2 Processing状态匹配修复

## 问题描述

R17.1 修复后仍存在匹配错误。R17的标题行和R17.1的标题行都不包含 `[Processing]`，但解析时仍错误匹配。

## 问题根因

在 `parser/index.ts` 的 `getFullTaskContent` 方法中：

```typescript
// 原代码 - 用空格连接描述行
const description = descriptionLines.join(' ').trim();
return description ? `${taskLine} ${description}` : taskLine;
```

这导致整个 `content` 中没有换行符 `\n`。

随后在 `parseTask` 方法中：

```typescript
const firstNewlineIndex = content.indexOf('\n');  // 返回 -1
const taskLine = firstNewlineIndex === -1 ? content : content.substring(0, firstNewlineIndex);
```

当 `firstNewlineIndex` 为 -1 时，`taskLine` 变成了**整个 content**，包括任务描述部分。因此 `[Processing]` 即使出现在描述中，也会被错误地检测到。

## 修复方案

将描述行用换行符连接：

```typescript
// 修复后 - 用换行符连接描述行
const description = descriptionLines.join('\n').trim();
return description ? `${taskLine}\n${description}` : taskLine;
```

这样 `content` 中包含换行符，`taskLine` 只提取第一行（任务标题行），正确区分 `[Processing]` 标记只应在任务标题行中。

## 修改文件

- `vscode-mdtodo/src/parser/index.ts:221-223`

## 验证方式

使用 `doc/review/20260120_MDTODO.md` 测试：
1. 确认 R17 和 R17.1 的标题行没有 `[Processing]` 标记
2. 点击 Claude 执行后，只在对应的 RXX 行后添加 `[Processing]`
3. WebUI 正确显示 Processing 状态
