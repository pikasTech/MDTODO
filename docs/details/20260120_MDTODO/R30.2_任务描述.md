# R30.2 一键安装脚本实现

## 任务目标

创建一个 `install.bat` 脚本，一键将 MDTODO 插件安装到本地常规的 VSCode 上（实际工作模式非调试模式）。

## 执行步骤

### 1. 创建 install.bat 脚本

在 `vscode-mdtodo` 目录下创建 `install.bat` 脚本：

```batch
@echo off
chcp 65001 >nul
echo ============================================
echo VSCode MDTODO Plugin Install Script
echo ============================================
echo.

cd /d "%~dp0"
setlocal

set VSIX_FILE=vscode-mdtodo-0.0.2.vsix

echo [1/3] Checking VSIX file...
echo.
if not exist "%VSIX_FILE%" (
    echo ERROR: %VSIX_FILE% not found!
    echo Please run pack.bat first to generate the VSIX file.
    exit /b 1
)
echo VSIX file found: %VSIX_FILE%
echo.

echo [2/3] Installing extension...
echo.
call code --install-extension "%VSIX_FILE%" --force
if errorlevel 1 (
    echo ERROR: Installation failed!
    echo Please make sure VSCode is installed and 'code' command is available.
    echo You can add VSCode to PATH by:
    echo   1. Open VSCode
    echo   2. Press Ctrl+Shift+P
    echo   3. Type "Shell Command: Install 'code' command in PATH"
    exit /b 1
)
echo Installation completed.
echo.

echo [3/3] Done!
echo.
echo The MDTODO plugin has been installed successfully!
echo.
echo To verify the installation:
echo   1. Open VSCode
echo   2. Press Ctrl+Shift+X to open Extensions panel
echo   3. Search for "MDTODO" to confirm it's installed
echo.
echo To use the plugin:
echo   1. Open a .md file
echo   2. Press Ctrl+Shift+P
echo   3. Type "MDTODO: Open" to launch the plugin
echo.

endlocal
pause
```

### 2. 脚本功能说明

- **检查阶段**：验证 VSIX 文件是否存在，如果不存在则提示先运行 `pack.bat`
- **安装阶段**：使用 `code --install-extension` 命令安装扩展
- **完成阶段**：显示安装成功提示和验证方法

### 3. 测试结果

#### 环境检查
- VSIX 文件：`vscode-mdtodo-0.0.2.vsix` 存在
- `code` 命令：可用，已添加到系统 PATH

#### 安装命令测试
```bash
code --install-extension vscode-mdtodo-0.0.2.vsix --force
```
命令执行成功。

## 使用方法

### 方式一：使用 install.bat 脚本（推荐）

1. 双击运行 `vscode-mdtodo\install.bat`
2. 等待安装完成
3. 重启 VSCode（如果之前已打开）
4. 打开任意 .md 文件，按 `Ctrl+Shift+P`，输入 "MDTODO: Open" 启动插件

### 方式二：手动安装

```bash
cd vscode-mdtodo
code --install-extension vscode-mdtodo-0.0.2.vsix --force
```

## 文件清单

| 文件 | 说明 |
|------|------|
| `pack.bat` | 打包脚本，生成 VSIX 文件 |
| `install.bat` | 安装脚本，一键安装插件到 VSCode |
| `vscode-mdtodo-0.0.2.vsix` | 插件安装包 |

## 注意事项

1. **VSCode 必须关闭或重启**：安装扩展后，需要重启 VSCode 才能使用新安装的插件
2. **code 命令必须可用**：如果 `code` 命令不在 PATH 中，需要先在 VSCode 中执行 "Shell Command: Install 'code' command in PATH"
3. **先打包后安装**：如果 VSIX 文件不存在，需要先运行 `pack.bat` 生成安装包
