# R5.1 布局优化执行

## 任务要求

1. 侧边栏默认占编辑区的一半的宽度
2. +子任务、删除、Claude执行等按钮应当放到任务内容文本区的下面然后右对齐

## 执行时间

2026-01-21

## 修改文件

- `vscode-mdtodo/src/webview/components/TaskList.tsx`
- `vscode-mdtodo/src/webview/components/TaskList.css`

## 修改内容

### 1. 按钮布局调整

**TaskList.tsx** - 修改 TaskItem 组件结构：

将原有的水平布局：
```
[task-main: 展开图标 | 复选框 | 内容 | 按钮组]
```

改为垂直布局：
```
[task-main:
  [task-main-left: 展开图标 | 复选框 | 内容]
  [task-actions: 按钮组（右对齐）]
]
```

关键修改：
- 新增 `.task-main-left` div 包裹展开图标、复选框和任务内容
- 将 `.task-actions` 从 `.task-main-left` 中移出，放到 `.task-main` 内部但在内容下方
- 分离了点击选择区域和按钮区域，避免点击按钮时触发任务选择

### 2. CSS 样式调整

**TaskList.css**：

```css
/* 修改 .task-main 为纵向布局 */
.task-main {
  display: flex;
  flex-direction: column;
  padding: 10px 12px;
  gap: 8px;
}

/* 新增 .task-main-left 样式 */
.task-main-left {
  display: flex;
  align-items: flex-start;
  gap: 10px;
  cursor: pointer;
}

/* 修改 .task-actions 为右对齐 */
.task-actions {
  flex-shrink: 0;
  display: flex;
  gap: 6px;
  justify-content: flex-end;
  margin-top: 4px;
}
```

### 3. 关于侧边栏宽度

**说明**：VSCode WebviewPanel API 目前不支持直接设置面板宽度比例。WebviewPanel 在右侧打开时会自动占据整个右侧列。

**替代方案**：
- 优化任务内容区域布局，使其占用更多空间
- 按钮移到内容下方后，任务内容区域不再被挤压

## 效果

1. 任务内容区域获得最大可用宽度，不再被按钮挤压
2. 按钮组统一在任务内容下方右对齐，视觉更整洁
3. 点击选择和按钮操作分离，避免误触发

## 构建测试

修改后需要重新构建插件：

```bash
cd vscode-mdtodo
npm run build
```

然后在 VSCode 中按 F5 启动扩展开发宿主测试。
