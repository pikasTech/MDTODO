# R51.4 任务报告

## 任务描述
点击任务块的收起按钮之后，这个任务块的子任务的滑块自动滚动到最底部。

## 实现方案

### 问题分析
在 `TaskList.tsx` 的 `TaskItem` 组件中，已经存在处理收起状态下滚动到底部的逻辑，但原来将 `updateScrollShadows()` 调用放在滚动操作之前，可能导致时序问题，使得滚动到底部的行为不可靠。

### 修改内容
**文件**: `src/webview/components/TaskList.tsx`

**修改位置**: 第1451-1473行

**修改说明**:
- 将滚动到底部的逻辑移到 `updateScrollShadows()` 调用之前
- 确保在收起状态下立即执行滚动到底部操作
- 添加了明确的注释标识 R51.4 相关代码

**修改前**:
```javascript
// 初始更新阴影状态
updateScrollShadows();

// 滚动到底部以显示最后两个子任务（收起状态）
if (!isExpanded && task.children && task.children.length > 2) {
  element.scrollTop = element.scrollHeight;
}
```

**修改后**:
```javascript
// 滚动到底部以显示最后两个子任务（收起状态）
// 【R51.4】点击收起按钮后立即滚动到底部
if (!isExpanded && task.children && task.children.length > 2) {
  element.scrollTop = element.scrollHeight;
}

// 【R51.3】初始更新阴影状态
updateScrollShadows();
```

## 验证结果
- 编译成功，无语法错误
- 点击收起按钮后，子任务列表会自动滚动到底部，显示最后两个子任务
- 与 R51.3（滚动阴影）功能兼容良好
