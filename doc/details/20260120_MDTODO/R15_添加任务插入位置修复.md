# R15 执行日志：添加任务插入位置修复

## 问题描述

以本文档为例，点击添加任务后，R15 竟然添加到了 R14 之前而不是之后。

## 问题分析

问题出在 `vscode-mdtodo/src/providers/webviewProvider.ts` 中的 `handleAddTask` 函数。

### 错误逻辑

原代码在查找"最后一个任务"时，会跳过包含 `[Finished]` 的已完成任务：

```javascript
// 原代码（错误）
if (line.match(/^##+\s+/) && !line.includes('[Finished]')) {
  // 跳过已完成的任务
}
```

当文档中 R14 是 `[Finished]`，而新任务 R15 不存在时，代码会：
1. 从文件末尾向前遍历
2. 遇到 R14（带 `[Finished]`），因为条件 `!line.includes('[Finished]')` 为 false 而跳过
3. 继续向前找到 R13
4. 在 R13 之后插入新任务 R15

这就导致了 R15 被插入到 R14 之前而不是之后的 bug。

## 修复方案

移除所有 `!line.includes('[Finished]')` 条件，使用更精确的任务标题匹配规则（检查是否包含 RXX 格式）。

### 修改内容

文件：`vscode-mdtodo/src/providers/webviewProvider.ts`

**修改前**：
```javascript
if (line.match(/^##+\s+/) && !line.includes('[Finished]')) {
  // ...
  if (nextLine.match(/^##+\s+/) && !nextLine.includes('[Finished]')) {
    lastTaskEnd = j;
    break;
  }
  if (nextLine.match(/^##+\s+/) && nextLine.includes('[Finished]')) {
    lastTaskEnd = j;
    break;
  }
}
```

**修改后**：
```javascript
if (line.match(/^##+\s+/) && line.match(/R\d+(?:\.\d+)*/)) {
  // ...
  if (nextLine.match(/^##+\s+/) && nextLine.match(/R\d+(?:\.\d+)*/)) {
    lastTaskEnd = j;
    break;
  }
}
```

## 修复效果

1. 新任务现在会正确插入到文件中最后一个任务之后
2. 不再区分任务是否已完成，所有任务都被平等对待
3. 使用 RXX 格式匹配更加精确，避免误匹配其他二级标题

## 验证方法

1. 打开 `doc/review/20260120_MDTODO.md` 文件
2. 点击"添加任务"按钮
3. 确认新任务（R15）被正确插入到 R14 之后，而不是 R14 之前
