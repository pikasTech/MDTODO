# R37.3.1 执行报告：跳转到下一个按钮添加数字徽章

## 任务描述

跳转到下一个未完成任务的按钮上面应该显示一个数字，类似未读消息的数字，提示还有多少个未完成的任务。

## 实现方案

### 1. 添加未完成任务计数状态（TaskList.tsx）

```typescript
// 【实现R37.3.1】计算未完成任务的数量
const incompleteCount = React.useMemo(() => {
  const allTasks = getAllTasks(tasks);
  return allTasks.filter(t => !t.completed && !t.processing).length;
}, [tasks]);
```

使用 `useMemo` 包装计算逻辑，确保只有在 `tasks` 变化时才重新计算，避免不必要的计算开销。

### 2. 修改按钮渲染（TaskList.tsx）

将原来的按钮包装在一个 `div` 中，并添加数字徽章：

```jsx
// 【实现R37.3】跳转到下一个未完成任务按钮 - 图标 + 数字徽章
React.createElement('div', { className: 'jump-next-btn-wrapper' },
  React.createElement('button', {
    className: `toolbar-icon-btn ${buttonCooldown[BUTTON_IDS.JUMP_TO_NEXT] ? 'disabled' : ''}`,
    disabled: buttonCooldown[BUTTON_IDS.JUMP_TO_NEXT],
    onClick: handleJumpToNextIncomplete,
    title: '跳转到下一个未完成任务（循环）'
  },
    React.createElement('svg', { viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2, width: 16, height: 16 },
      React.createElement('circle', { cx: '12', cy: '12', r: '10' }),
      React.createElement('polyline', { points: '12 6 16 10 12 14' }),
      React.createElement('line', { x1: '8', y1: '10', x2: '8', y2: '14' })
    )
  ),
  // 【实现R37.3.1】数字徽章，显示未完成任务数量
  incompleteCount > 0 && React.createElement('span', {
    className: 'jump-next-badge'
  }, incompleteCount)
)
```

### 3. 添加徽章样式（TaskList.css）

```css
/* 【实现R37.3.1】跳转到下一个按钮包装器，用于定位徽章 */
.jump-next-btn-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* 【实现R37.3.1】数字徽章样式 */
.jump-next-badge {
  position: absolute;
  top: -4px;
  right: -4px;
  min-width: 16px;
  height: 16px;
  padding: 0 4px;
  border-radius: 8px;
  background-color: #d97706;
  color: white;
  font-size: 10px;
  font-weight: 600;
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  border: 1px solid #1e1e1e;
  z-index: 10;
}
```

## 效果说明

- 徽章使用与Claude执行按钮相同的橙黄色（#d97706），保持视觉风格一致
- 徽章显示在按钮右上角，采用圆角胶囊形状
- 当没有未完成任务时，徽章自动隐藏
- 徽章数字会根据任务状态变化自动更新

## 修改文件列表

1. `vscode-mdtodo/src/webview/components/TaskList.tsx`
   - 添加 `incompleteCount` 状态计算
   - 修改按钮渲染，添加徽章

2. `vscode-mdtodo/src/webview/components/TaskList.css`
   - 添加 `.jump-next-btn-wrapper` 和 `.jump-next-badge` 样式
