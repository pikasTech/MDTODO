# R34 执行记录：文件名标题实现

## 任务描述

将 webview 左上角的"MDTODO 任务管理"替换成当前的文件名（例如20260120_MDTODO，不带.md后缀）。

## 实现方案

1. 添加 `getFileName` 函数：从文件路径提取文件名并去掉 .md 后缀
2. 添加 `displayTitle` 状态：存储用于显示的标题
3. 在接收 `updateTasks` 消息时更新 `displayTitle`
4. 将标题位置从固定文本改为使用 `displayTitle` 状态

## 代码修改

### 修改文件：`vscode-mdtodo/src/webview/components/TaskList.tsx`

#### 1. 添加文件名提取函数和状态（第83-92行）

```tsx
// 【实现R34】从文件路径提取文件名作为标题
const getFileName = (path: string): string => {
  if (!path) return 'MDTODO 任务管理';
  // 提取文件名并去掉 .md 后缀
  const fileName = path.split('/').pop()?.split('\\').pop() || '';
  return fileName.replace(/\.md$/i, '') || 'MDTODO 任务管理';
};

// 用于显示的标题，从 filePath 派生
const [displayTitle, setDisplayTitle] = React.useState(() => getFileName(filePath));
```

#### 2. 在消息处理中更新标题（第197-200行）

```tsx
// 【修复R25】更新filePath状态
setCurrentFilePath(message.filePath || '');
// 【实现R34】更新显示标题（从文件路径提取文件名，不带.md后缀）
setDisplayTitle(getFileName(message.filePath || ''));
```

#### 3. 修改标题显示（第889-890行）

```tsx
React.createElement('header', { className: 'header' },
  React.createElement('h1', null, displayTitle),
```

## 测试验证

编译成功，功能已实现。

## 效果

- 打开文件 `20260120_MDTODO.md` 时，标题显示为 `20260120_MDTODO`
- 切换到其他 TODO 文件时，标题自动更新为对应的文件名
- 如果未加载文件，显示默认文本 `MDTODO 任务管理`
