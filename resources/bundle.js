var MDTODO;(()=>{"use strict";var e={56(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},72(e){var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var l={},o=[],i=0;i<e.length;i++){var a=e[i],c=r.base?a[0]+r.base:a[0],p=l[c]||0,d="".concat(c," ").concat(p);l[c]=p+1;var u=n(d),h={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==u)t[u].references++,t[u].updater(h);else{var g=s(h,r);r.byIndex=i,t.splice(i,0,{identifier:d,updater:g,references:1})}o.push(d)}return o}function s(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,s){var l=r(e=e||[],s=s||{});return function(e){e=e||[];for(var o=0;o<l.length;o++){var i=n(l[o]);t[i].references--}for(var a=r(e,s),c=0;c<l.length;c++){var p=n(l[c]);0===t[p].references&&(t[p].updater(),t.splice(p,1))}l=a}}},113(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},206(e){e.exports=ReactDOM},314(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,r,s,l){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var c=0;c<e.length;c++){var p=[].concat(e[c]);r&&o[p[0]]||(void 0!==l&&(void 0===p[5]||(p[1]="@layer".concat(p[5].length>0?" ".concat(p[5]):""," {").concat(p[1],"}")),p[5]=l),n&&(p[2]?(p[1]="@media ".concat(p[2]," {").concat(p[1],"}"),p[2]=n):p[2]=n),s&&(p[4]?(p[1]="@supports (".concat(p[4],") {").concat(p[1],"}"),p[4]=s):p[4]="".concat(s)),t.push(p))}},t}},338(e,t,n){var r=n(206);t.H=r.createRoot,r.hydrateRoot},540(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},601(e){e.exports=function(e){return e[1]}},659(e){var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},711(e,t,n){n.d(t,{A:()=>i});var r=n(601),s=n.n(r),l=n(314),o=n.n(l)()(s());o.push([e.id,".app {\n  display: flex;\n  flex-direction: column;\n  height: 100vh;\n  background-color: #1e1e1e;\n  color: #d4d4d4;\n  padding: 0 20px;\n}\n\n.header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 12px 16px;\n  border-bottom: 1px solid #3c3c3c;\n  flex-shrink: 0;\n}\n\n.header h1 {\n  font-size: 16px;\n  font-weight: 600;\n  color: #ffffff;\n}\n\n.header-actions {\n  display: flex;\n  gap: 8px;\n  align-items: center;\n}\n\n.btn {\n  padding: 6px 12px;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 13px;\n}\n\n.btn-primary {\n  background-color: #007acc;\n  color: white;\n}\n\n.btn-primary:hover {\n  background-color: #0062a3;\n}\n\n.btn-primary.disabled,\n.btn-primary:disabled {\n  background-color: #4a6a8a;\n  color: #888;\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.btn-secondary {\n  background-color: #3c3c3c;\n  color: #d4d4d4;\n}\n\n.btn-secondary:hover {\n  background-color: #4c4c4c;\n}\n\n.btn-secondary.disabled,\n.btn-secondary:disabled {\n  background-color: #2c2c2c;\n  color: #666;\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.task-container {\n  flex: 1;\n  overflow-y: auto;\n  padding: 12px;\n}\n\n.task-list {\n  list-style: none;\n  display: flex;\n  flex-direction: column;\n  gap: 12px;\n}\n\n.task-item {\n  display: flex;\n  flex-direction: column;\n}\n\n.task-card {\n  background-color: #252526;\n  border: 1px solid #3c3c3c;\n  border-radius: 6px;\n  overflow: hidden;\n}\n\n/* 执行中任务样式 */\n.task-item.processing .task-card {\n  border-color: #d97706;\n  box-shadow: 0 0 8px rgba(217, 119, 6, 0.3);\n}\n\n.task-item.processing .task-checkbox {\n  border-color: #d97706;\n  animation: checkboxPulse 1.5s ease-in-out infinite;\n}\n\n@keyframes checkboxPulse {\n  0%, 100% {\n    box-shadow: 0 0 0 0 rgba(217, 119, 6, 0.4);\n  }\n  50% {\n    box-shadow: 0 0 0 4px rgba(217, 119, 6, 0.1);\n  }\n}\n\n.task-main {\n  display: flex;\n  flex-direction: column;\n  padding: 10px 12px;\n  gap: 8px;\n}\n\n/* 左侧可点击区域 - 包含展开图标、复选框和内容 */\n.task-main-left {\n  display: flex;\n  align-items: flex-start;\n  gap: 10px;\n  cursor: pointer;\n}\n\n.task-main-left:focus {\n  outline: 2px solid #007acc;\n  outline-offset: -2px;\n}\n\n.expand-icon {\n  width: 20px;\n  height: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  margin-top: 2px;\n  color: #888;\n  font-size: 10px;\n  flex-shrink: 0;\n  cursor: pointer;\n}\n\n.expand-icon.expanded {\n  transform: rotate(90deg);\n}\n\n.task-checkbox {\n  width: 16px;\n  height: 16px;\n  border: 2px solid #555;\n  border-radius: 3px;\n  margin-top: 3px;\n  flex-shrink: 0;\n  cursor: pointer;\n}\n\n.task-checkbox.checked {\n  background-color: #007acc;\n  border-color: #007acc;\n}\n\n.task-checkbox.checked::after {\n  content: '✓';\n  color: white;\n  font-size: 11px;\n  display: block;\n  text-align: center;\n}\n\n.task-content {\n  flex: 1;\n  min-width: 0;\n  overflow: hidden;\n}\n\n.task-id-wrapper {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  margin-bottom: 4px;\n}\n\n.task-id {\n  font-size: 11px;\n  color: #6a737d;\n  font-family: 'Consolas', 'Monaco', monospace;\n}\n\n.processing-badge {\n  font-size: 10px;\n  padding: 2px 6px;\n  border-radius: 3px;\n  background-color: #d97706;\n  color: white;\n  font-weight: 500;\n  animation: pulse 1.5s ease-in-out infinite;\n}\n\n@keyframes pulse {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.6;\n  }\n}\n\n.task-title {\n  font-size: 14px;\n  color: #e0e0e0;\n  line-height: 1.5;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  outline: none;\n}\n\n/* 【修复R22.4/R27】编辑模式使用原生textarea，高度根据内容动态调整 */\n.task-title-edit {\n  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n  font-size: 14px;\n  background-color: #1e1e1e;\n  border: 1px solid #3c3c3c;\n  border-radius: 3px;\n  color: #e0e0e0;\n  padding: 8px 12px;\n  width: 100%;\n  resize: vertical;\n  outline: none;\n  line-height: 1.5;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  overflow-wrap: break-word;\n  min-height: 0; /* 覆盖CSS默认，由JS动态控制高度 */\n}\n\n.task-title-edit:focus {\n  border-color: #007acc;\n  box-shadow: 0 0 0 2px rgba(0, 122, 204, 0.2);\n}\n\n.task-title-edit::placeholder {\n  color: #666;\n}\n\n.task-title code {\n  background-color: #3c3c3c;\n  padding: 2px 4px;\n  border-radius: 3px;\n  font-size: 12px;\n}\n\n.task-title a {\n  color: #3794ff;\n}\n\n/* Markdown渲染元素样式 - 在非编辑模式下生效 */\n.task-title:not(.edit-mode) h1,\n.task-title:not(.edit-mode) h2,\n.task-title:not(.edit-mode) h3,\n.task-title:not(.edit-mode) h4,\n.task-title:not(.edit-mode) h5,\n.task-title:not(.edit-mode) h6 {\n  margin: 8px 0 4px;\n  font-weight: 600;\n  color: #ffffff;\n}\n\n.task-title:not(.edit-mode) h1 { font-size: 16px; }\n.task-title:not(.edit-mode) h2 { font-size: 15px; }\n.task-title:not(.edit-mode) h3 { font-size: 14px; }\n.task-title:not(.edit-mode) h4 { font-size: 13px; }\n.task-title:not(.edit-mode) h5,\n.task-title:not(.edit-mode) h6 { font-size: 12px; color: #888; }\n\n.task-title:not(.edit-mode) p {\n  margin: 4px 0;\n}\n\n.task-title:not(.edit-mode) strong {\n  font-weight: 600;\n  color: #ffffff;\n}\n\n.task-title:not(.edit-mode) em {\n  font-style: italic;\n}\n\n.task-title:not(.edit-mode) ul,\n.task-title:not(.edit-mode) ol {\n  margin: 4px 0;\n  padding-left: 24px;\n}\n\n.task-title:not(.edit-mode) li {\n  margin: 2px 0;\n}\n\n.task-title:not(.edit-mode) blockquote {\n  margin: 4px 0;\n  padding: 4px 12px;\n  border-left: 3px solid #3c3c3c;\n  background-color: #2d2d2d;\n  color: #888;\n}\n\n.task-title:not(.edit-mode) pre {\n  margin: 4px 0;\n  padding: 8px 12px;\n  background-color: #2d2d2d;\n  border-radius: 4px;\n  overflow-x: auto;\n}\n\n.task-title:not(.edit-mode) pre code {\n  background-color: transparent;\n  padding: 0;\n  font-size: 12px;\n  color: #d4d4d4;\n}\n\n.task-title:not(.edit-mode) hr {\n  margin: 8px 0;\n  border: none;\n  border-top: 1px solid #3c3c3c;\n}\n\n.task-title:not(.edit-mode) table {\n  margin: 4px 0;\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.task-title:not(.edit-mode) table th,\n.task-title:not(.edit-mode) table td {\n  border: 1px solid #3c3c3c;\n  padding: 4px 8px;\n  text-align: left;\n}\n\n.task-title:not(.edit-mode) table th {\n  background-color: #2d2d2d;\n}\n\n.task-actions {\n  flex-shrink: 0;\n  display: flex;\n  gap: 6px;\n  justify-content: flex-end;\n  margin-top: 4px;\n}\n\n.action-btn {\n  padding: 4px 10px;\n  border: none;\n  border-radius: 3px;\n  cursor: pointer;\n  font-size: 12px;\n  background-color: #3c3c3c;\n  color: #d4d4d4;\n  transition: background-color 0.15s;\n}\n\n.action-btn:hover {\n  background-color: #4c4c4c;\n}\n\n.action-btn.active {\n  background-color: #007acc;\n  color: white;\n}\n\n.action-btn.disabled,\n.action-btn:disabled {\n  background-color: #2c2c2c;\n  color: #666;\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.action-btn.claude-btn {\n  background-color: #d97706;\n  color: white;\n}\n\n.action-btn.claude-btn:hover {\n  background-color: #b45309;\n}\n\n.action-btn.claude-btn.disabled,\n.action-btn.claude-btn:disabled {\n  background-color: #6b5b3d;\n  color: #999;\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.children {\n  margin-left: 24px;\n  border-left: 1px solid #3c3c3c;\n  padding-left: 16px;\n  padding-top: 8px;\n  overflow: hidden;\n  transition: max-height 0.2s ease-out;\n}\n\n.children.collapsed {\n  max-height: 0 !important;\n}\n\n.status-bar {\n  padding: 8px 16px;\n  border-top: 1px solid #3c3c3c;\n  font-size: 12px;\n  color: #888;\n  display: flex;\n  justify-content: space-between;\n  flex-shrink: 0;\n}\n\n.file-path {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 400px;\n}\n\n::-webkit-scrollbar {\n  width: 8px;\n}\n\n::-webkit-scrollbar-track {\n  background: #1e1e1e;\n}\n\n::-webkit-scrollbar-thumb {\n  background: #424242;\n  border-radius: 4px;\n}\n\n::-webkit-scrollbar-thumb:hover {\n  background: #555;\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  color: #888;\n}\n\n.empty-state-icon {\n  font-size: 48px;\n  margin-bottom: 16px;\n  opacity: 0.5;\n}\n\n.toolbar {\n  margin-bottom: 12px;\n}\n\n.toolbar .btn {\n  margin-right: 8px;\n}\n\n.delete-btn {\n  background-color: #c0392b !important;\n  color: white !important;\n}\n\n.delete-btn:hover {\n  background-color: #e74c3c !important;\n}\n\n/* 筛选栏样式 - 浮动在顶部 */\n.filter-bar {\n  display: flex;\n  flex-wrap: wrap;\n  align-items: center;\n  gap: 16px;\n  padding: 10px 12px;\n  background-color: #1e1e1e;\n  border-bottom: 1px solid #3c3c3c;\n  position: sticky;\n  top: 0;\n  z-index: 50;\n}\n\n.filter-group {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.filter-label {\n  font-size: 12px;\n  color: #888;\n  white-space: nowrap;\n}\n\n.filter-buttons {\n  display: flex;\n  gap: 4px;\n}\n\n.filter-btn {\n  padding: 4px 12px;\n  border: 1px solid #3c3c3c;\n  border-radius: 4px;\n  background-color: #1e1e1e;\n  color: #d4d4d4;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.filter-btn:hover {\n  background-color: #3c3c3c;\n}\n\n.filter-btn.active {\n  background-color: #007acc;\n  border-color: #007acc;\n  color: white;\n}\n\n.search-input {\n  padding: 6px 12px;\n  border: 1px solid #3c3c3c;\n  border-radius: 4px;\n  background-color: #1e1e1e;\n  color: #d4d4d4;\n  font-size: 13px;\n  width: 180px;\n  outline: none;\n  transition: border-color 0.15s ease;\n}\n\n.search-input:focus {\n  border-color: #007acc;\n}\n\n.search-input::placeholder {\n  color: #666;\n}\n\n.clear-search-btn {\n  padding: 4px 8px;\n  border: none;\n  border-radius: 4px;\n  background-color: #3c3c3c;\n  color: #d4d4d4;\n  font-size: 16px;\n  cursor: pointer;\n  transition: background-color 0.15s ease;\n  line-height: 1;\n}\n\n.clear-search-btn:hover {\n  background-color: #c0392b;\n}\n\n.clear-filter-btn {\n  padding: 4px 12px;\n  border: 1px solid #c0392b;\n  border-radius: 4px;\n  background-color: transparent;\n  color: #e74c3c;\n  font-size: 12px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.clear-filter-btn:hover {\n  background-color: #c0392b;\n  color: white;\n}\n\n/* 筛选栏内的添加任务按钮 */\n.add-task-btn {\n  padding: 4px 12px !important;\n  font-size: 12px !important;\n}\n\n.filter-stats {\n  font-size: 12px;\n  color: #888;\n  margin-left: auto;\n  white-space: nowrap;\n}\n\n/* 【实现R28】任务跳转下拉菜单样式 */\n.jump-select {\n  padding: 6px 12px;\n  border: 1px solid #3c3c3c;\n  border-radius: 4px;\n  background-color: #1e1e1e;\n  color: #d4d4d4;\n  font-size: 13px;\n  outline: none;\n  cursor: pointer;\n  min-width: 120px;\n  transition: border-color 0.15s ease;\n}\n\n.jump-select:focus {\n  border-color: #007acc;\n}\n\n.jump-select:hover {\n  border-color: #555;\n}\n\n.jump-select option {\n  background-color: #1e1e1e;\n  color: #d4d4d4;\n  padding: 8px;\n}\n\n/* 【实现R29.2】双向滚动同步开关按钮样式 */\n.sync-scroll-btn {\n  padding: 6px;\n  border: 1px solid #3c3c3c;\n  border-radius: 4px;\n  background-color: #1e1e1e;\n  color: #888;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s ease;\n}\n\n.sync-scroll-btn:hover {\n  background-color: #3c3c3c;\n  color: #d4d4d4;\n}\n\n.sync-scroll-btn.enabled {\n  background-color: #1e3a1e;\n  border-color: #2d7a2d;\n  color: #4ade4a;\n}\n\n.sync-scroll-btn.enabled:hover {\n  background-color: #2d5a2d;\n  color: #6ee06e;\n}\n\n.sync-scroll-btn svg {\n  width: 16px;\n  height: 16px;\n}\n\n/* 【R37.2】工具栏图标按钮样式 */\n.toolbar-icon-btn {\n  padding: 6px;\n  border: 1px solid #3c3c3c;\n  border-radius: 4px;\n  background-color: #1e1e1e;\n  color: #888;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.15s ease;\n}\n\n.toolbar-icon-btn:hover {\n  background-color: #3c3c3c;\n  color: #d4d4d4;\n}\n\n.toolbar-icon-btn.disabled,\n.toolbar-icon-btn:disabled {\n  background-color: #2c2c2c;\n  color: #666;\n  cursor: not-allowed;\n  opacity: 0.7;\n}\n\n.toolbar-icon-btn svg {\n  width: 16px;\n  height: 16px;\n}\n\n/* 【实现R37.3.1】跳转到下一个按钮包装器，用于定位徽章 */\n.jump-next-btn-wrapper {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n/* 【实现R37.3.1】数字徽章样式 */\n.jump-next-badge {\n  position: absolute;\n  top: -4px;\n  right: -4px;\n  min-width: 16px;\n  height: 16px;\n  padding: 0 4px;\n  border-radius: 8px;\n  background-color: #d97706;\n  color: white;\n  font-size: 10px;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  line-height: 1;\n  border: 1px solid #1e1e1e;\n  z-index: 10;\n}\n\n/* 【实现R39】链接状态图标样式 */\n.link-status-icon {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 11px;\n  font-weight: 500;\n  cursor: help;\n  transition: all 0.15s ease;\n}\n\n/* 全部链接存在时的样式 - 绿色 */\n.link-status-icon.link-complete {\n  background-color: rgba(45, 122, 45, 0.2);\n  border: 1px solid #2d7a2d;\n  color: #4ade4a;\n}\n\n/* 部分链接存在时的样式 - 黄色/橙色 */\n.link-status-icon.link-partial {\n  background-color: rgba(217, 119, 6, 0.2);\n  border: 1px solid #d97706;\n  color: #fbbf24;\n}\n\n/* 悬停效果 */\n.link-status-icon:hover {\n  filter: brightness(1.1);\n}\n\n/* 链接计数文字 */\n.link-count {\n  font-family: 'Consolas', 'Monaco', monospace;\n}\n",""]);const i=o},825(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var s=void 0!==n.layer;s&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,s&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var l=n.sourceMap;l&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(l))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var l=t[r]={id:r,exports:{}};return e[r](l,l.exports,n),l.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;const r=React;var s=n(338);var l={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};function o(e){l=e}var i={exec:()=>null};function a(e,t=""){let n="string"==typeof e?e:e.source,r={replace:(e,t)=>{let s="string"==typeof t?t:t.source;return s=s.replace(p.caret,"$1"),n=n.replace(e,s),r},getRegex:()=>new RegExp(n,t)};return r}var c=(()=>{try{return!!new RegExp("(?<=1)(?<!1)")}catch{return!1}})(),p={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] +\S/,listReplaceTask:/^\[[ xX]\] +/,listTaskCheckbox:/\[[ xX]\]/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[\t ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},d=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,u=/(?:[*+-]|\d{1,9}[.)])/,h=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,g=a(h).replace(/bull/g,u).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),k=a(h).replace(/bull/g,u).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),b=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,f=/(?!\s*\])(?:\\[\s\S]|[^\[\]\\])+/,m=a(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",f).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),x=a(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,u).getRegex(),w="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",y=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,v=a("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ \t]*)+\\n|$))","i").replace("comment",y).replace("tag",w).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),E=a(b).replace("hr",d).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",w).getRegex(),S={blockquote:a(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",E).getRegex(),code:/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,def:m,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,hr:d,html:v,lheading:g,list:x,newline:/^(?:[ \t]*(?:\n|$))+/,paragraph:E,table:i,text:/^[^\n]+/},T=a("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",d).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}\t)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",w).getRegex(),C={...S,lheading:k,table:T,paragraph:a(b).replace("hr",d).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",T).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",w).getRegex()},$={...S,html:a("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",y).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:i,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:a(b).replace("hr",d).replace("heading"," *#{1,6} *[^\n]").replace("lheading",g).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},R=/^( {2,}|\\)\n(?!\s*$)/,z=/[\p{P}\p{S}]/u,O=/[\s\p{P}\p{S}]/u,A=/[^\s\p{P}\p{S}]/u,j=a(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,O).getRegex(),N=/(?!~)[\p{P}\p{S}]/u,I=a(/link|precode-code|html/,"g").replace("link",/\[(?:[^\[\]`]|(?<a>`+)[^`]+\k<a>(?!`))*?\]\((?:\\[\s\S]|[^\\\(\)]|\((?:\\[\s\S]|[^\\\(\)])*\))*\)/).replace("precode-",c?"(?<!`)()":"(^^|[^`])").replace("code",/(?<b>`+)[^`]+\k<b>(?!`)/).replace("html",/<(?! )[^<>]*?>/).getRegex(),_=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,M=a(_,"u").replace(/punct/g,z).getRegex(),P=a(_,"u").replace(/punct/g,N).getRegex(),B="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",L=a(B,"gu").replace(/notPunctSpace/g,A).replace(/punctSpace/g,O).replace(/punct/g,z).getRegex(),D=a(B,"gu").replace(/notPunctSpace/g,/(?:[^\s\p{P}\p{S}]|~)/u).replace(/punctSpace/g,/(?!~)[\s\p{P}\p{S}]/u).replace(/punct/g,N).getRegex(),W=a("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,A).replace(/punctSpace/g,O).replace(/punct/g,z).getRegex(),q=a(/\\(punct)/,"gu").replace(/punct/g,z).getRegex(),H=a(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Z=a(y).replace("(?:--\x3e|$)","--\x3e").getRegex(),Q=a("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Z).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),V=/(?:\[(?:\\[\s\S]|[^\[\]\\])*\]|\\[\s\S]|`+[^`]*?`+(?!`)|[^\[\]\\`])*?/,F=a(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",V).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),G=a(/^!?\[(label)\]\[(ref)\]/).replace("label",V).replace("ref",f).getRegex(),U=a(/^!?\[(ref)\](?:\[\])?/).replace("ref",f).getRegex(),X=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,J={_backpedal:i,anyPunctuation:q,autolink:H,blockSkip:I,br:R,code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,del:i,emStrongLDelim:M,emStrongRDelimAst:L,emStrongRDelimUnd:W,escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,link:F,nolink:U,punctuation:j,reflink:G,reflinkSearch:a("reflink|nolink(?!\\()","g").replace("reflink",G).replace("nolink",U).getRegex(),tag:Q,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,url:i},K={...J,link:a(/^!?\[(label)\]\((.*?)\)/).replace("label",V).getRegex(),reflink:a(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",V).getRegex()},Y={...J,emStrongRDelimAst:D,emStrongLDelim:P,url:a(/^((?:protocol):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("protocol",X).replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\[\s\S]|[^\\])*?(?:\\[\s\S]|[^\s~\\]))\1(?=[^~]|$)/,text:a(/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|protocol:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/).replace("protocol",X).getRegex()},ee={...Y,br:a(R).replace("{2,}","*").getRegex(),text:a(Y.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},te={normal:S,gfm:C,pedantic:$},ne={normal:J,gfm:Y,breaks:ee,pedantic:K},re={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},se=e=>re[e];function le(e,t){if(t){if(p.escapeTest.test(e))return e.replace(p.escapeReplace,se)}else if(p.escapeTestNoEncode.test(e))return e.replace(p.escapeReplaceNoEncode,se);return e}function oe(e){try{e=encodeURI(e).replace(p.percentDecode,"%")}catch{return null}return e}function ie(e,t){let n=e.replace(p.findPipe,(e,t,n)=>{let r=!1,s=t;for(;--s>=0&&"\\"===n[s];)r=!r;return r?"|":" |"}).split(p.splitPipe),r=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),t)if(n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(p.slashPipe,"|");return n}function ae(e,t,n){let r=e.length;if(0===r)return"";let s=0;for(;s<r;){let l=e.charAt(r-s-1);if(l!==t||n){if(l===t||!n)break;s++}else s++}return e.slice(0,r-s)}function ce(e,t,n,r,s){let l=t.href,o=t.title||null,i=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;let a={type:"!"===e[0].charAt(0)?"image":"link",raw:n,href:l,title:o,text:i,tokens:r.inlineTokens(i)};return r.state.inLink=!1,a}var pe=class{options;rules;lexer;constructor(e){this.options=e||l}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let e=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?e:ae(e,"\n")}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let e=t[0],n=function(e,t,n){let r=e.match(n.other.indentCodeCompensation);if(null===r)return t;let s=r[1];return t.split("\n").map(e=>{let t=e.match(n.other.beginningSpace);if(null===t)return e;let[r]=t;return r.length>=s.length?e.slice(s.length):e}).join("\n")}(e,t[3]||"",this.rules);return{type:"code",raw:e,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:n}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let e=t[2].trim();if(this.rules.other.endingHash.test(e)){let t=ae(e,"#");(this.options.pedantic||!t||this.rules.other.endingSpaceChar.test(t))&&(e=t.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:e,tokens:this.lexer.inline(e)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:ae(t[0],"\n")}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let e=ae(t[0],"\n").split("\n"),n="",r="",s=[];for(;e.length>0;){let t,l=!1,o=[];for(t=0;t<e.length;t++)if(this.rules.other.blockquoteStart.test(e[t]))o.push(e[t]),l=!0;else{if(l)break;o.push(e[t])}e=e.slice(t);let i=o.join("\n"),a=i.replace(this.rules.other.blockquoteSetextReplace,"\n    $1").replace(this.rules.other.blockquoteSetextReplace2,"");n=n?`${n}\n${i}`:i,r=r?`${r}\n${a}`:a;let c=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(a,s,!0),this.lexer.state.top=c,0===e.length)break;let p=s.at(-1);if("code"===p?.type)break;if("blockquote"===p?.type){let t=p,l=t.raw+"\n"+e.join("\n"),o=this.blockquote(l);s[s.length-1]=o,n=n.substring(0,n.length-t.raw.length)+o.raw,r=r.substring(0,r.length-t.text.length)+o.text;break}if("list"===p?.type){let t=p,l=t.raw+"\n"+e.join("\n"),o=this.list(l);s[s.length-1]=o,n=n.substring(0,n.length-p.raw.length)+o.raw,r=r.substring(0,r.length-t.raw.length)+o.raw,e=l.substring(s.at(-1).raw.length).split("\n");continue}}return{type:"blockquote",raw:n,tokens:s,text:r}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");let l=this.rules.other.listItemRegex(n),o=!1;for(;e;){let n=!1,r="",i="";if(!(t=l.exec(e))||this.rules.block.hr.test(e))break;r=t[0],e=e.substring(r.length);let a=t[2].split("\n",1)[0].replace(this.rules.other.listReplaceTabs,e=>" ".repeat(3*e.length)),c=e.split("\n",1)[0],p=!a.trim(),d=0;if(this.options.pedantic?(d=2,i=a.trimStart()):p?d=t[1].length+1:(d=t[2].search(this.rules.other.nonSpaceChar),d=d>4?1:d,i=a.slice(d),d+=t[1].length),p&&this.rules.other.blankLine.test(c)&&(r+=c+"\n",e=e.substring(c.length+1),n=!0),!n){let t=this.rules.other.nextBulletRegex(d),n=this.rules.other.hrRegex(d),s=this.rules.other.fencesBeginRegex(d),l=this.rules.other.headingBeginRegex(d),o=this.rules.other.htmlBeginRegex(d);for(;e;){let u,h=e.split("\n",1)[0];if(c=h,this.options.pedantic?(c=c.replace(this.rules.other.listReplaceNesting,"  "),u=c):u=c.replace(this.rules.other.tabCharGlobal,"    "),s.test(c)||l.test(c)||o.test(c)||t.test(c)||n.test(c))break;if(u.search(this.rules.other.nonSpaceChar)>=d||!c.trim())i+="\n"+u.slice(d);else{if(p||a.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||s.test(a)||l.test(a)||n.test(a))break;i+="\n"+c}!p&&!c.trim()&&(p=!0),r+=h+"\n",e=e.substring(h.length+1),a=u.slice(d)}}s.loose||(o?s.loose=!0:this.rules.other.doubleBlankLine.test(r)&&(o=!0)),s.items.push({type:"list_item",raw:r,task:!!this.options.gfm&&this.rules.other.listIsTask.test(i),loose:!1,text:i,tokens:[]}),s.raw+=r}let i=s.items.at(-1);if(!i)return;i.raw=i.raw.trimEnd(),i.text=i.text.trimEnd(),s.raw=s.raw.trimEnd();for(let e of s.items){if(this.lexer.state.top=!1,e.tokens=this.lexer.blockTokens(e.text,[]),e.task){if(e.text=e.text.replace(this.rules.other.listReplaceTask,""),"text"===e.tokens[0]?.type||"paragraph"===e.tokens[0]?.type){e.tokens[0].raw=e.tokens[0].raw.replace(this.rules.other.listReplaceTask,""),e.tokens[0].text=e.tokens[0].text.replace(this.rules.other.listReplaceTask,"");for(let e=this.lexer.inlineQueue.length-1;e>=0;e--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[e].src)){this.lexer.inlineQueue[e].src=this.lexer.inlineQueue[e].src.replace(this.rules.other.listReplaceTask,"");break}}let t=this.rules.other.listTaskCheckbox.exec(e.raw);if(t){let n={type:"checkbox",raw:t[0]+" ",checked:"[ ]"!==t[0]};e.checked=n.checked,s.loose?e.tokens[0]&&["paragraph","text"].includes(e.tokens[0].type)&&"tokens"in e.tokens[0]&&e.tokens[0].tokens?(e.tokens[0].raw=n.raw+e.tokens[0].raw,e.tokens[0].text=n.raw+e.tokens[0].text,e.tokens[0].tokens.unshift(n)):e.tokens.unshift({type:"paragraph",raw:n.raw,text:n.raw,tokens:[n]}):e.tokens.unshift(n)}}if(!s.loose){let t=e.tokens.filter(e=>"space"===e.type),n=t.length>0&&t.some(e=>this.rules.other.anyLine.test(e.raw));s.loose=n}}if(s.loose)for(let e of s.items){e.loose=!0;for(let t of e.tokens)"text"===t.type&&(t.type="paragraph")}return s}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:"pre"===t[1]||"script"===t[1]||"style"===t[1],text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let e=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),n=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",r=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:e,raw:t[0],href:n,title:r}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=ie(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split("\n"):[],l={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let e of r)this.rules.other.tableAlignRight.test(e)?l.align.push("right"):this.rules.other.tableAlignCenter.test(e)?l.align.push("center"):this.rules.other.tableAlignLeft.test(e)?l.align.push("left"):l.align.push(null);for(let e=0;e<n.length;e++)l.header.push({text:n[e],tokens:this.lexer.inline(n[e]),header:!0,align:l.align[e]});for(let e of s)l.rows.push(ie(e,l.header.length).map((e,t)=>({text:e,tokens:this.lexer.inline(e),header:!1,align:l.align[t]})));return l}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:"="===t[2].charAt(0)?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let e="\n"===t[1].charAt(t[1].length-1)?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:e,tokens:this.lexer.inline(e)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let e=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(e)){if(!this.rules.other.endAngleBracket.test(e))return;let t=ae(e.slice(0,-1),"\\");if((e.length-t.length)%2==0)return}else{let e=function(e,t){if(-1===e.indexOf(t[1]))return-1;let n=0;for(let r=0;r<e.length;r++)if("\\"===e[r])r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}(t[2],"()");if(-2===e)return;if(e>-1){let n=(0===t[0].indexOf("!")?5:4)+t[1].length+e;t[2]=t[2].substring(0,e),t[0]=t[0].substring(0,n).trim(),t[3]=""}}let n=t[2],r="";if(this.options.pedantic){let e=this.rules.other.pedanticHrefTitle.exec(n);e&&(n=e[1],r=e[3])}else r=t[3]?t[3].slice(1,-1):"";return n=n.trim(),this.rules.other.startAngleBracket.test(n)&&(n=this.options.pedantic&&!this.rules.other.endAngleBracket.test(e)?n.slice(1):n.slice(1,-1)),ce(t,{href:n&&n.replace(this.rules.inline.anyPunctuation,"$1"),title:r&&r.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let e=t[(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," ").toLowerCase()];if(!e){let e=n[0].charAt(0);return{type:"text",raw:e,text:e}}return ce(n,e,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))&&(!r[1]&&!r[2]||!n||this.rules.inline.punctuation.exec(n))){let n,s,l=[...r[0]].length-1,o=l,i=0,a="*"===r[0][0]?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(a.lastIndex=0,t=t.slice(-1*e.length+l);null!=(r=a.exec(t));){if(n=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!n)continue;if(s=[...n].length,r[3]||r[4]){o+=s;continue}if((r[5]||r[6])&&l%3&&!((l+s)%3)){i+=s;continue}if(o-=s,o>0)continue;s=Math.min(s,s+o+i);let t=[...r[0]][0].length,a=e.slice(0,l+r.index+t+s);if(Math.min(l,s)%2){let e=a.slice(1,-1);return{type:"em",raw:a,text:e,tokens:this.lexer.inlineTokens(e)}}let c=a.slice(2,-2);return{type:"strong",raw:a,text:c,tokens:this.lexer.inlineTokens(c)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let e=t[2].replace(this.rules.other.newLineCharGlobal," "),n=this.rules.other.nonSpaceChar.test(e),r=this.rules.other.startingSpaceChar.test(e)&&this.rules.other.endingSpaceChar.test(e);return n&&r&&(e=e.substring(1,e.length-1)),{type:"codespan",raw:t[0],text:e}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let e,n;return"@"===t[2]?(e=t[1],n="mailto:"+e):(e=t[1],n=e),{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let e,n;if("@"===t[2])e=t[0],n="mailto:"+e;else{let r;do{r=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??""}while(r!==t[0]);e=t[0],n="www."===t[1]?"http://"+t[0]:t[0]}return{type:"link",raw:t[0],text:e,href:n,tokens:[{type:"text",raw:e,text:e}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let e=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:e}}}},de=class e{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||l,this.options.tokenizer=this.options.tokenizer||new pe,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:p,block:te.normal,inline:ne.normal};this.options.pedantic?(t.block=te.pedantic,t.inline=ne.pedantic):this.options.gfm&&(t.block=te.gfm,this.options.breaks?t.inline=ne.breaks:t.inline=ne.gfm),this.tokenizer.rules=t}static get rules(){return{block:te,inline:ne}}static lex(t,n){return new e(n).lex(t)}static lexInline(t,n){return new e(n).inlineTokens(t)}lex(e){e=e.replace(p.carriageReturn,"\n"),this.blockTokens(e,this.tokens);for(let e=0;e<this.inlineQueue.length;e++){let t=this.inlineQueue[e];this.inlineTokens(t.src,t.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(p.tabCharGlobal,"    ").replace(p.spaceLine,""));e;){let r;if(this.options.extensions?.block?.some(n=>!!(r=n.call({lexer:this},e,t))&&(e=e.substring(r.raw.length),t.push(r),!0)))continue;if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length);let n=t.at(-1);1===r.raw.length&&void 0!==n?n.raw+="\n":t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length);let n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+=(n.raw.endsWith("\n")?"":"\n")+r.raw,n.text+="\n"+r.text,this.inlineQueue.at(-1).src=n.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length);let n=t.at(-1);"paragraph"===n?.type||"text"===n?.type?(n.raw+=(n.raw.endsWith("\n")?"":"\n")+r.raw,n.text+="\n"+r.raw,this.inlineQueue.at(-1).src=n.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title},t.push(r));continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}let s=e;if(this.options.extensions?.startBlock){let t,n=1/0,r=e.slice(1);this.options.extensions.startBlock.forEach(e=>{t=e.call({lexer:this},r),"number"==typeof t&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(s=e.substring(0,n+1))}if(this.state.top&&(r=this.tokenizer.paragraph(s))){let l=t.at(-1);n&&"paragraph"===l?.type?(l.raw+=(l.raw.endsWith("\n")?"":"\n")+r.raw,l.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=l.text):t.push(r),n=s.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length);let n=t.at(-1);"text"===n?.type?(n.raw+=(n.raw.endsWith("\n")?"":"\n")+r.raw,n.text+="\n"+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=n.text):t.push(r);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,r=e,s=null;if(this.tokens.links){let e=Object.keys(this.tokens.links);if(e.length>0)for(;null!=(s=this.tokenizer.rules.inline.reflinkSearch.exec(r));)e.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;null!=(s=this.tokenizer.rules.inline.anyPunctuation.exec(r));)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;null!=(s=this.tokenizer.rules.inline.blockSkip.exec(r));)n=s[2]?s[2].length:0,r=r.slice(0,s.index+n)+"["+"a".repeat(s[0].length-n-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);r=this.options.hooks?.emStrongMask?.call({lexer:this},r)??r;let l=!1,o="";for(;e;){let n;if(l||(o=""),l=!1,this.options.extensions?.inline?.some(r=>!!(n=r.call({lexer:this},e,t))&&(e=e.substring(n.raw.length),t.push(n),!0)))continue;if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length);let r=t.at(-1);"text"===n.type&&"text"===r?.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,r,o)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}let s=e;if(this.options.extensions?.startInline){let t,n=1/0,r=e.slice(1);this.options.extensions.startInline.forEach(e=>{t=e.call({lexer:this},r),"number"==typeof t&&t>=0&&(n=Math.min(n,t))}),n<1/0&&n>=0&&(s=e.substring(0,n+1))}if(n=this.tokenizer.inlineText(s)){e=e.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(o=n.raw.slice(-1)),l=!0;let r=t.at(-1);"text"===r?.type?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(e){let t="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(t);break}throw new Error(t)}}return t}},ue=class{options;parser;constructor(e){this.options=e||l}space(e){return""}code({text:e,lang:t,escaped:n}){let r=(t||"").match(p.notSpaceStart)?.[0],s=e.replace(p.endingNewline,"")+"\n";return r?'<pre><code class="language-'+le(r)+'">'+(n?s:le(s,!0))+"</code></pre>\n":"<pre><code>"+(n?s:le(s,!0))+"</code></pre>\n"}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}def(e){return""}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return"<hr>\n"}list(e){let t=e.ordered,n=e.start,r="";for(let t=0;t<e.items.length;t++){let n=e.items[t];r+=this.listitem(n)}let s=t?"ol":"ul";return"<"+s+(t&&1!==n?' start="'+n+'"':"")+">\n"+r+"</"+s+">\n"}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>\n`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t="",n="";for(let t=0;t<e.header.length;t++)n+=this.tablecell(e.header[t]);t+=this.tablerow({text:n});let r="";for(let t=0;t<e.rows.length;t++){let s=e.rows[t];n="";for(let e=0;e<s.length;e++)n+=this.tablecell(s[e]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),"<table>\n<thead>\n"+t+"</thead>\n"+r+"</table>\n"}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${le(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),s=oe(e);if(null===s)return r;let l='<a href="'+(e=s)+'"';return t&&(l+=' title="'+le(t)+'"'),l+=">"+r+"</a>",l}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let s=oe(e);if(null===s)return le(n);let l=`<img src="${e=s}" alt="${n}"`;return t&&(l+=` title="${le(t)}"`),l+=">",l}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:le(e.text)}},he=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}checkbox({raw:e}){return e}},ge=class e{options;renderer;textRenderer;constructor(e){this.options=e||l,this.options.renderer=this.options.renderer||new ue,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new he}static parse(t,n){return new e(n).parse(t)}static parseInline(t,n){return new e(n).parseInline(t)}parse(e){let t="";for(let n=0;n<e.length;n++){let r=e[n];if(this.options.extensions?.renderers?.[r.type]){let e=r,n=this.options.extensions.renderers[e.type].call({parser:this},e);if(!1!==n||!["space","hr","heading","code","table","blockquote","list","html","def","paragraph","text"].includes(e.type)){t+=n||"";continue}}let s=r;switch(s.type){case"space":t+=this.renderer.space(s);break;case"hr":t+=this.renderer.hr(s);break;case"heading":t+=this.renderer.heading(s);break;case"code":t+=this.renderer.code(s);break;case"table":t+=this.renderer.table(s);break;case"blockquote":t+=this.renderer.blockquote(s);break;case"list":t+=this.renderer.list(s);break;case"checkbox":t+=this.renderer.checkbox(s);break;case"html":t+=this.renderer.html(s);break;case"def":t+=this.renderer.def(s);break;case"paragraph":t+=this.renderer.paragraph(s);break;case"text":t+=this.renderer.text(s);break;default:{let e='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return t}parseInline(e,t=this.renderer){let n="";for(let r=0;r<e.length;r++){let s=e[r];if(this.options.extensions?.renderers?.[s.type]){let e=this.options.extensions.renderers[s.type].call({parser:this},s);if(!1!==e||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=e||"";continue}}let l=s;switch(l.type){case"escape":case"text":n+=t.text(l);break;case"html":n+=t.html(l);break;case"link":n+=t.link(l);break;case"image":n+=t.image(l);break;case"checkbox":n+=t.checkbox(l);break;case"strong":n+=t.strong(l);break;case"em":n+=t.em(l);break;case"codespan":n+=t.codespan(l);break;case"br":n+=t.br(l);break;case"del":n+=t.del(l);break;default:{let e='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(e),"";throw new Error(e)}}}return n}},ke=class{options;block;constructor(e){this.options=e||l}static passThroughHooks=new Set(["preprocess","postprocess","processAllTokens","emStrongMask"]);static passThroughHooksRespectAsync=new Set(["preprocess","postprocess","processAllTokens"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?de.lex:de.lexInline}provideParser(){return this.block?ge.parse:ge.parseInline}},be=new class{defaults={async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null};options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=ge;Renderer=ue;TextRenderer=he;Lexer=de;Tokenizer=pe;Hooks=ke;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case"table":{let e=r;for(let r of e.header)n=n.concat(this.walkTokens(r.tokens,t));for(let r of e.rows)for(let e of r)n=n.concat(this.walkTokens(e.tokens,t));break}case"list":{let e=r;n=n.concat(this.walkTokens(e.items,t));break}default:{let e=r;this.defaults.extensions?.childTokens?.[e.type]?this.defaults.extensions.childTokens[e.type].forEach(r=>{let s=e[r].flat(1/0);n=n.concat(this.walkTokens(s,t))}):e.tokens&&(n=n.concat(this.walkTokens(e.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(e=>{let n={...e};if(n.async=this.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach(e=>{if(!e.name)throw new Error("extension name required");if("renderer"in e){let n=t.renderers[e.name];t.renderers[e.name]=n?function(...t){let r=e.renderer.apply(this,t);return!1===r&&(r=n.apply(this,t)),r}:e.renderer}if("tokenizer"in e){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");let n=t[e.level];n?n.unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}"childTokens"in e&&e.childTokens&&(t.childTokens[e.name]=e.childTokens)}),n.extensions=t),e.renderer){let t=this.defaults.renderer||new ue(this.defaults);for(let n in e.renderer){if(!(n in t))throw new Error(`renderer '${n}' does not exist`);if(["options","parser"].includes(n))continue;let r=n,s=e.renderer[r],l=t[r];t[r]=(...e)=>{let n=s.apply(t,e);return!1===n&&(n=l.apply(t,e)),n||""}}n.renderer=t}if(e.tokenizer){let t=this.defaults.tokenizer||new pe(this.defaults);for(let n in e.tokenizer){if(!(n in t))throw new Error(`tokenizer '${n}' does not exist`);if(["options","rules","lexer"].includes(n))continue;let r=n,s=e.tokenizer[r],l=t[r];t[r]=(...e)=>{let n=s.apply(t,e);return!1===n&&(n=l.apply(t,e)),n}}n.tokenizer=t}if(e.hooks){let t=this.defaults.hooks||new ke;for(let n in e.hooks){if(!(n in t))throw new Error(`hook '${n}' does not exist`);if(["options","block"].includes(n))continue;let r=n,s=e.hooks[r],l=t[r];ke.passThroughHooks.has(n)?t[r]=e=>{if(this.defaults.async&&ke.passThroughHooksRespectAsync.has(n))return(async()=>{let n=await s.call(t,e);return l.call(t,n)})();let r=s.call(t,e);return l.call(t,r)}:t[r]=(...e)=>{if(this.defaults.async)return(async()=>{let n=await s.apply(t,e);return!1===n&&(n=await l.apply(t,e)),n})();let n=s.apply(t,e);return!1===n&&(n=l.apply(t,e)),n}}n.hooks=t}if(e.walkTokens){let t=this.defaults.walkTokens,r=e.walkTokens;n.walkTokens=function(e){let n=[];return n.push(r.call(this,e)),t&&(n=n.concat(t.call(this,e))),n}}this.defaults={...this.defaults,...n}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return de.lex(e,t??this.defaults)}parser(e,t){return ge.parse(e,t??this.defaults)}parseMarkdown(e){return(t,n)=>{let r={...n},s={...this.defaults,...r},l=this.onError(!!s.silent,!!s.async);if(!0===this.defaults.async&&!1===r.async)return l(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof t>"u"||null===t)return l(new Error("marked(): input parameter is undefined or null"));if("string"!=typeof t)return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(t)+", string expected"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let n=s.hooks?await s.hooks.preprocess(t):t,r=await(s.hooks?await s.hooks.provideLexer():e?de.lex:de.lexInline)(n,s),l=s.hooks?await s.hooks.processAllTokens(r):r;s.walkTokens&&await Promise.all(this.walkTokens(l,s.walkTokens));let o=await(s.hooks?await s.hooks.provideParser():e?ge.parse:ge.parseInline)(l,s);return s.hooks?await s.hooks.postprocess(o):o})().catch(l);try{s.hooks&&(t=s.hooks.preprocess(t));let n=(s.hooks?s.hooks.provideLexer():e?de.lex:de.lexInline)(t,s);s.hooks&&(n=s.hooks.processAllTokens(n)),s.walkTokens&&this.walkTokens(n,s.walkTokens);let r=(s.hooks?s.hooks.provideParser():e?ge.parse:ge.parseInline)(n,s);return s.hooks&&(r=s.hooks.postprocess(r)),r}catch(e){return l(e)}}}onError(e,t){return n=>{if(n.message+="\nPlease report this to https://github.com/markedjs/marked.",e){let e="<p>An error occurred:</p><pre>"+le(n.message+"",!0)+"</pre>";return t?Promise.resolve(e):e}if(t)return Promise.reject(n);throw n}}};function fe(e,t){return be.parse(e,t)}fe.options=fe.setOptions=function(e){return be.setOptions(e),fe.defaults=be.defaults,o(fe.defaults),fe},fe.getDefaults=function(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}},fe.defaults=l,fe.use=function(...e){return be.use(...e),fe.defaults=be.defaults,o(fe.defaults),fe},fe.walkTokens=function(e,t){return be.walkTokens(e,t)},fe.parseInline=be.parseInline,fe.Parser=ge,fe.parser=ge.parse,fe.Renderer=ue,fe.TextRenderer=he,fe.Lexer=de,fe.lexer=de.lex,fe.Tokenizer=pe,fe.Hooks=ke,fe.parse=fe,fe.options,fe.setOptions,fe.use,fe.walkTokens,fe.parseInline,ge.parse,de.lex;var me=n(72),xe=n.n(me),we=n(825),ye=n.n(we),ve=n(659),Ee=n.n(ve),Se=n(56),Te=n.n(Se),Ce=n(540),$e=n.n(Ce),Re=n(113),ze=n.n(Re),Oe=n(711),Ae={};Ae.styleTagTransform=ze(),Ae.setAttributes=Te(),Ae.insert=Ee().bind(null,"head"),Ae.domAPI=ye(),Ae.insertStyleElement=$e(),xe()(Oe.A,Ae),Oe.A&&Oe.A.locals&&Oe.A.locals,fe.setOptions({breaks:!0,gfm:!0});const je="expandAll",Ne="collapseAll",Ie="refresh",_e="openFile",Me="openSourceFile",Pe="addTask",Be="deleteTask",Le="addSubTask",De="scrollToTop",We="scrollToBottom",qe="jumpToNext",He=e=>{const{initialTasks:t=[],initialTextBlocks:n=[],filePath:s="",vscodeApi:l,onSaveComplete:o}=e,[i,a]=r.useState(t),[c,p]=r.useState(n),[d,u]=r.useState(s||""),[h,g]=r.useState(new Set([])),[k,b]=r.useState({}),[f,m]=r.useState({total:0,completed:0}),[x,w]=r.useState(null),[y,v]=r.useState(null),[E,S]=r.useState(new Set),T=r.useRef(E);T.current=E;const[C,$]=r.useState({}),[R,z]=r.useState({}),O=100,[A,j]=r.useState("all"),[N,I]=r.useState(""),[_,M]=r.useState(""),P=r.useRef(null),B=(r.useRef(null),r.useRef("")),L=r.useRef(0),[D,W]=r.useState(!1),[q,H]=r.useState(-1),Z=e=>{var t;return e&&((null===(t=e.split("/").pop())||void 0===t?void 0:t.split("\\").pop())||"").replace(/\.md$/i,"")||"MDTODO 任务管理"},[Q,V]=r.useState(()=>Z(s)),F=e=>{console.log("[Webview] handleSaveComplete: 退出编辑模式",e),b(t=>Object.assign(Object.assign({},t),{[e]:!1})),S(t=>{const n=new Set(t);return n.delete(e),n}),o&&o(e)},G=(e,t)=>{console.log("[Webview] handleRefreshTaskTitle:",e,t),a(n=>{const r=n=>n.map(n=>n.id===e?Object.assign(Object.assign({},n),{title:t}):n.children&&n.children.length>0?Object.assign(Object.assign({},n),{children:r(n.children)}):n);return r(n)}),g(t=>new Set(t).add(e)),b(t=>{const n=Object.assign({},t);return delete n[e],n}),S(t=>{const n=new Set(t);return n.delete(e),n})},U=e=>{l?l.postMessage(e):(w("VSCode API not available - 请重新加载窗口"),console.error("[Webview] sendMessage failed: vscodeApi is",l))};r.useEffect(()=>{const e=J(i);m({total:e.length,completed:e.filter(e=>e.completed).length})},[i]),r.useEffect(()=>{if(y){console.log("[Webview] pendingScrollTaskId effect triggered for:",y);const e=document.querySelector(`[data-task-id="${y}"]`);e&&(e.scrollIntoView({behavior:"smooth",block:"start"}),b(e=>{const t={};return Object.keys(e).forEach(e=>{t[e]=e===y}),t}),S(new Set([y])),console.log("[Webview] 已进入编辑模式并确保互斥:",y),v(null))}},[y]),r.useEffect(()=>{const e=e=>{var t,n;const r=e.data;if("updateTasks"===r.type){console.log("[Webview] Received updateTasks, tasks:",null===(t=r.tasks)||void 0===t?void 0:t.length,"textBlocks:",null===(n=r.textBlocks)||void 0===n?void 0:n.length,"filePath:",r.filePath),a(r.tasks||[]),p(r.textBlocks||[]),u(r.filePath||""),V(Z(r.filePath||""));const e=X(r.tasks||[]);g(new Set(e));const s=Array.from(T.current);console.log("[Webview] updateTasks: 正在编辑的任务:",s),b(t=>{const n={};return s.forEach(t=>{e.includes(t)&&(n[t]=!0)}),n}),S(t=>{const n=new Set(t);return s.forEach(t=>{e.includes(t)||n.delete(t)}),n}),console.log("[Webview] updateTasks: 已更新编辑状态，保留正在编辑的任务")}else if("newTaskAdded"===r.type){v(r.taskId),S(new Set([r.taskId])),b({[r.taskId]:!0}),console.log("[Webview] newTaskAdded: 设置新任务",r.taskId,"为编辑状态");const e=r.taskId.split(".").slice(0,-1).join(".");e&&g(t=>new Set([...t,e]))}else"refreshTaskTitle"===r.type?G(r.taskId,r.newTitle):"scrollToTask"===r.type&&he(r.taskId,r.lineNumber)};return window.addEventListener("message",e),"undefined"!=typeof window&&(void 0===window.MDTODO&&(window.MDTODO={}),window.MDTODO.updateTaskState=(e,t)=>{G(e,t)}),()=>{window.removeEventListener("message",e)}},[]);const X=e=>{let t=[];for(const n of e)t.push(n.id),n.children&&n.children.length>0&&(t=t.concat(X(n.children)));return t},J=e=>{let t=[];for(const n of e)t.push(n),n.children&&n.children.length>0&&(t=t.concat(J(n.children)));return t},K=r.useMemo(()=>J(i).filter(e=>!e.completed&&!e.processing).length,[i]),Y=e=>{g(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n})},ee=e=>{const t=`toggleComplete_${e}`;R[t]?console.log("[Webview] 完成复选框防抖，跳过重复点击"):(U({type:"markComplete",taskId:e}),z(e=>Object.assign(Object.assign({},e),{[t]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[t]:!1}))},O))},te=e=>{U({type:"taskSelected",taskId:e})},ne=e=>{const t=!k[e];console.log("[Webview] handleToggleEdit:",e,"->",t?"编辑模式":"非编辑模式"),t?(b({[e]:!0}),S(new Set([e]))):(b(t=>{const n=Object.assign({},t);return delete n[e],n}),S(t=>{const n=new Set(t);return n.delete(e),n}))},re=e=>{console.log("[Webview] handleDoubleClick: 进入编辑模式",e),b({[e]:!0}),S(new Set([e]))},se=(e,t)=>{U({type:"saveTitle",taskId:e,title:t})},le=()=>{R[_e]?console.log("[Webview] 打开文件按钮防抖，跳过重复点击"):(U({type:"openFile"}),z(e=>Object.assign(Object.assign({},e),{[_e]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[_e]:!1}))},O))},oe=e=>{C[e]?console.log("[Webview] Claude执行防抖，跳过重复点击"):(U({type:"claudeExecute",taskId:e}),$(t=>Object.assign(Object.assign({},t),{[e]:!0})),setTimeout(()=>{$(t=>Object.assign(Object.assign({},t),{[e]:!1}))},100))},ie=()=>{R[Pe]?console.log("[Webview] 添加任务按钮防抖，跳过重复点击"):(U({type:"addTask"}),z(e=>Object.assign(Object.assign({},e),{[Pe]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[Pe]:!1}))},O))},ae=e=>{const t=`${Be}_${e}`;R[t]?console.log("[Webview] 删除按钮防抖，跳过重复点击"):(U({type:"deleteTask",taskId:e}),z(e=>Object.assign(Object.assign({},e),{[t]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[t]:!1}))},O))},ce=e=>{const t=`${Le}_${e}`;R[t]?console.log("[Webview] 添加子任务按钮防抖，跳过重复点击"):(console.log("[Webview] Sending addSubTask, taskId:",e),U({type:"addSubTask",taskId:e}),z(e=>Object.assign(Object.assign({},e),{[t]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[t]:!1}))},O))},pe=e=>e.map(e=>{const t=e.children?pe(e.children):[],n=Object.assign(Object.assign({},e),{children:t.length>0?t:void 0}),r=!n.completed&&!n.processing,s="all"===A||"active"===A&&r||"hide-completed"===A&&!n.completed||"processing"===A&&n.processing&&!n.completed,l=""===N.trim()||n.title.toLowerCase().includes(N.toLowerCase())||n.id.toLowerCase().includes(N.toLowerCase());return s&&l||t.length>0?n:null}).filter(e=>null!==e),de=pe(i),ue=()=>{j("all"),I("")},he=(e,t)=>{console.log("[Webview] scrollToTask:",e,"line:",t);const n=e.split(".").slice(0,-1).join(".");n&&g(e=>new Set([...e,n])),setTimeout(()=>{const t=document.querySelector(`[data-task-id="${e}"]`);t&&(t.scrollIntoView({behavior:"smooth",block:"start"}),B.current=e)},50)},ge=(e,t)=>{const n=e.target;if("A"===n.tagName&&n instanceof HTMLAnchorElement){e.preventDefault(),e.stopPropagation();const t=n.getAttribute("href");t&&(console.log("[Webview] 点击链接:",t),U({type:"openLink",url:t}))}},ke=r.useCallback(()=>{if(!D)return;const e=Date.now();if(e-L.current<300)return;L.current=e;const t=document.querySelectorAll("[data-task-id]");let n=null,r=1/0;const s=document.querySelector(".task-container"),l=null==s?void 0:s.getBoundingClientRect();l&&(t.forEach(e=>{const t=e.getAttribute("data-task-id");if(!t)return;const s=e.getBoundingClientRect().top-l.top;if(s>=-50&&s<r){r=s;const l=be(i,t);l&&(n={id:t,lineNumber:l.lineNumber,element:e})}}),n&&n.id!==B.current&&(B.current=n.id,console.log("[Webview] Sending scroll sync:",n.id,"line:",n.lineNumber),U({type:"webviewActive"}),U({type:"webviewScrolled",taskId:n.id,lineNumber:n.lineNumber})))},[i,U]),be=(e,t)=>{for(const n of e){if(n.id===t)return n;if(n.children&&n.children.length>0){const e=be(n.children,t);if(e)return e}}},me=r.useCallback(()=>{U({type:"webviewActive"})},[U]);r.useEffect(()=>{const e=document.querySelector(".task-container");if(e){const t=()=>{me(),ke()};return e.addEventListener("scroll",t,{passive:!0}),e.addEventListener("click",me,{passive:!0}),()=>{e.removeEventListener("scroll",t),e.removeEventListener("click",me)}}},[ke,me,D]);const xe="all"!==A||""!==N.trim(),we=e=>{const t=e.target;if("A"===t.tagName&&t instanceof HTMLAnchorElement){e.preventDefault(),e.stopPropagation();const n=t.getAttribute("href");n&&(console.log("[Webview] 点击文本块链接:",n),U({type:"openLink",url:n}))}};return r.createElement("div",{className:"app"},r.createElement("header",{className:"header"},r.createElement("h1",null,Q),r.createElement("div",{className:"header-actions"},r.createElement("button",{className:"sync-scroll-btn "+(D?"enabled":""),onClick:()=>{const e=!D;W(e),console.log("[Webview] 双向滚动同步:",e?"开启":"关闭"),U({type:"syncScrollChanged",enabled:e})},title:D?"关闭双向滚动同步":"开启双向滚动同步"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("path",{d:"M17 1l4 4-4 4"}),r.createElement("path",{d:"M3 11V9a4 4 0 0 1 4-4h14"}),r.createElement("path",{d:"M7 23l-4-4 4-4"}),r.createElement("path",{d:"M21 13v2a4 4 0 0 1-4 4H3"}))),r.createElement("button",{className:"toolbar-icon-btn "+(R[je]?"disabled":""),disabled:R[je],onClick:()=>{if(R[je])return void console.log("[Webview] 展开按钮防抖，跳过重复点击");const e=X(i);g(new Set(e)),z(e=>Object.assign(Object.assign({},e),{[je]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[je]:!1}))},O)},title:"全部展开"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("polyline",{points:"15 3 21 3 21 9"}),r.createElement("polyline",{points:"9 21 3 21 3 15"}),r.createElement("line",{x1:"21",y1:"3",x2:"14",y2:"10"}),r.createElement("line",{x1:"3",y1:"21",x2:"10",y2:"14"}))),r.createElement("button",{className:"toolbar-icon-btn "+(R[Ne]?"disabled":""),disabled:R[Ne],onClick:()=>{R[Ne]?console.log("[Webview] 收起按钮防抖，跳过重复点击"):(g(new Set),z(e=>Object.assign(Object.assign({},e),{[Ne]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[Ne]:!1}))},O))},title:"全部收起"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("polyline",{points:"4 14 10 14 10 20"}),r.createElement("polyline",{points:"20 10 14 10 14 4"}),r.createElement("line",{x1:"14",y1:"10",x2:"21",y2:"3"}),r.createElement("line",{x1:"3",y1:"21",x2:"10",y2:"14"}))),r.createElement("button",{className:"toolbar-icon-btn "+(R[Ie]?"disabled":""),disabled:R[Ie],onClick:()=>{R[Ie]?console.log("[Webview] 刷新按钮防抖，跳过重复点击"):(U({type:"refresh"}),z(e=>Object.assign(Object.assign({},e),{[Ie]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[Ie]:!1}))},O))},title:"刷新"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("polyline",{points:"23 4 23 10 17 10"}),r.createElement("path",{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"}))),r.createElement("button",{className:"toolbar-icon-btn "+(R[_e]?"disabled":""),disabled:R[_e],onClick:le,title:"打开文件"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),r.createElement("polyline",{points:"14 2 14 8 20 8"}),r.createElement("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),r.createElement("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),r.createElement("polyline",{points:"10 9 9 9 8 9"}))),r.createElement("button",{className:"toolbar-icon-btn "+(R[Me]?"disabled":""),disabled:R[Me],onClick:()=>{R[Me]?console.log("[Webview] 打开原文按钮防抖，跳过重复点击"):(U({type:"openSourceFile"}),z(e=>Object.assign(Object.assign({},e),{[Me]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[Me]:!1}))},O))},title:"在VSCode中打开原文"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),r.createElement("polyline",{points:"15 3 21 3 21 9"}),r.createElement("line",{x1:"10",y1:"14",x2:"21",y2:"3"}))),r.createElement("button",{className:"toolbar-icon-btn "+(R[De]?"disabled":""),disabled:R[De],onClick:()=>{if(R[De])return void console.log("[Webview] 顶部按钮防抖，跳过重复点击");const e=document.querySelector(".task-container");e&&e.scrollTo({top:0,behavior:"smooth"}),z(e=>Object.assign(Object.assign({},e),{[De]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[De]:!1}))},O)},title:"快速到顶部"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("polyline",{points:"18 15 12 9 6 15"}))),r.createElement("button",{className:"toolbar-icon-btn "+(R[We]?"disabled":""),disabled:R[We],onClick:()=>{if(R[We])return void console.log("[Webview] 底部按钮防抖，跳过重复点击");const e=document.querySelector(".task-container");e&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),z(e=>Object.assign(Object.assign({},e),{[We]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[We]:!1}))},O)},title:"快速到底部"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("polyline",{points:"6 9 12 15 18 9"}))),r.createElement("div",{className:"jump-next-btn-wrapper"},r.createElement("button",{className:"toolbar-icon-btn "+(R[qe]?"disabled":""),disabled:R[qe],onClick:()=>{if(R[qe])return void console.log("[Webview] 下一个按钮防抖，跳过重复点击");const e=J(i).filter(e=>!e.completed&&!e.processing);if(0===e.length)return console.log("[Webview] 没有未完成的任务"),z(e=>Object.assign(Object.assign({},e),{[qe]:!0})),void setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[qe]:!1}))},O);let t=0;q>=0&&q<e.length-1?t=q+1:q>=e.length-1&&(t=0);const n=e[t];if(n){const e=n.id.split(".").slice(0,-1).join(".");e&&g(t=>new Set([...t,e])),setTimeout(()=>{const e=document.querySelector(`[data-task-id="${n.id}"]`);e&&e.scrollIntoView({behavior:"smooth",block:"start"})},50),H(t)}z(e=>Object.assign(Object.assign({},e),{[qe]:!0})),setTimeout(()=>{z(e=>Object.assign(Object.assign({},e),{[qe]:!1}))},O)},title:"跳转到下一个未完成任务（循环）"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:16,height:16},r.createElement("circle",{cx:"12",cy:"12",r:"10"}),r.createElement("polyline",{points:"12 6 16 10 12 14"}),r.createElement("line",{x1:"8",y1:"10",x2:"8",y2:"14"}))),K>0&&r.createElement("span",{className:"jump-next-badge"},K)))),i.length>0&&(()=>{const e=(()=>{const e=J(de);return{total:e.length,completed:e.filter(e=>e.completed).length}})(),t=J(i).map(e=>e.id);return r.createElement("div",{className:"filter-bar"},r.createElement("div",{className:"filter-group"},r.createElement("span",{className:"filter-label"},"跳转:"),r.createElement("select",{className:"jump-select",value:_,onChange:e=>(e=>{if(M(e),e){const t=e.split(".").slice(0,-1).join(".");t&&g(e=>new Set([...e,t])),setTimeout(()=>{const t=document.querySelector(`[data-task-id="${e}"]`);t&&t.scrollIntoView({behavior:"smooth",block:"start"})},50)}})(e.target.value)},r.createElement("option",{value:""},"-- 选择任务 --"),t.map(e=>r.createElement("option",{key:e,value:e},e)))),r.createElement("div",{className:"filter-group"},r.createElement("span",{className:"filter-label"},"状态:"),r.createElement("div",{className:"filter-buttons"},r.createElement("button",{className:"filter-btn "+("all"===A?"active":""),onClick:()=>j("all")},"全部"),r.createElement("button",{className:"filter-btn "+("active"===A?"active":""),onClick:()=>j("active")},"未开始"),r.createElement("button",{className:"filter-btn "+("processing"===A?"active":""),onClick:()=>j("processing")},"进行中"),r.createElement("button",{className:"filter-btn "+("hide-completed"===A?"active":""),onClick:()=>j("hide-completed")},"隐藏已完成"))),r.createElement("div",{className:"filter-group"},r.createElement("span",{className:"filter-label"},"搜索:"),r.createElement("input",{type:"text",className:"search-input",placeholder:"输入关键词搜索...",value:N,onChange:e=>I(e.target.value)}),N&&r.createElement("button",{className:"clear-search-btn",onClick:()=>I(""),title:"清除搜索"},"×")),xe&&r.createElement("button",{className:"clear-filter-btn",onClick:ue},"清除筛选"),r.createElement("button",{className:"btn btn-primary add-task-btn "+(R[Pe]?"disabled":""),disabled:R[Pe],onClick:ie,title:"添加新任务"},"+ 添加任务"),r.createElement("div",{className:"filter-stats"},`显示 ${e.total} 个任务，${e.completed} 已完成`))})(),r.createElement("main",{className:"task-container"},x?r.createElement("div",{className:"api-error",style:{padding:"12px",backgroundColor:"#c0392b",color:"white",marginBottom:"12px",borderRadius:"4px",fontSize:"13px"}},`错误: ${x} - 请重新加载窗口`):null,c.length>0&&(c&&0!==c.length?r.createElement("div",{className:"text-blocks"},c.map(e=>{let t;try{t=fe.parse(e.content,{async:!1})}catch(n){console.error("[Webview] TextBlock Markdown渲染错误:",n),t=e.content.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}return r.createElement("div",{key:e.id,className:"text-block",style:{padding:"8px 12px",margin:"4px 0",backgroundColor:"#2d2d2d",borderRadius:"4px",fontSize:"13px",color:"#a0a0a0",lineHeight:"1.5",cursor:"pointer"},dangerouslySetInnerHTML:{__html:t},onClick:we})})):null),0===i.length?r.createElement("div",{className:"empty-state"},r.createElement("div",{className:"empty-state-icon"},"📋"),r.createElement("p",null,"暂未加载任务文件"),r.createElement("button",{className:"btn btn-primary",style:{marginTop:"16px"},onClick:le},"打开文件")):null,i.length>0&&0===de.length?r.createElement("div",{className:"empty-state"},r.createElement("div",{className:"empty-state-icon"},"🔍"),r.createElement("p",null,"没有匹配的任务"),r.createElement("button",{className:"btn btn-secondary",style:{marginTop:"16px"},onClick:ue},"清除筛选")):null,i.length>0&&de.length>0&&r.createElement("ul",{className:"task-list",ref:P},de.map(e=>r.createElement(Ze,{key:e.id,task:e,depth:0,expandedTasks:h,editModes:k,buttonCooldown:R,onToggleExpand:Y,onToggleComplete:ee,onSelect:te,onToggleEdit:ne,onSaveTitle:se,onClaudeExecute:oe,onDelete:ae,onAddSubTask:ce,claudeExecuting:C,onDoubleClick:re,onSaveComplete:F,onTaskContentClick:ge})))),r.createElement("footer",{className:"status-bar"},r.createElement("span",{className:"file-path"},d||"未选择文件"),r.createElement("span",{className:"stats"},`共 ${f.total} 个任务，${f.completed} 已完成`)))},Ze=e=>{const{task:t,depth:n,expandedTasks:s,editModes:l,claudeExecuting:o,buttonCooldown:i,onToggleExpand:a,onToggleComplete:c,onSelect:p,onToggleEdit:d,onSaveTitle:u,onClaudeExecute:h,onDelete:g,onAddSubTask:k,onDoubleClick:b,onSaveComplete:f,onTaskContentClick:m}=e,x=r.useRef(null),[w,y]=r.useState(t.rawContent||t.title),v=e=>{const t=(e.match(/\n/g)||[]).length+1;return 32*Math.max(3,Math.min(15,t))+24+"px"},[E,S]=r.useState(()=>v(t.rawContent||t.title));r.useEffect(()=>{S(v(w))},[w]);const T=t.children&&t.children.length>0,C=s.has(t.id),$=l[t.id]||!1,R=""===(t.rawContent||t.title).trim()&&$,z={maxHeight:C?"2000px":"0",marginLeft:24+16*n+"px"};r.useEffect(()=>{$&&y(t.rawContent||t.title)},[$,t.rawContent,t.title]),r.useEffect(()=>{$&&x.current&&(x.current.focus(),x.current.selectionStart=0,x.current.selectionEnd=0)},[$]);const O=`task-item ${t.completed?"completed":""} ${t.processing?"processing":""}`;return r.createElement("li",{className:O,"data-task-id":t.id},r.createElement("div",{className:"task-card",onDoubleClick:()=>b(t.id)},r.createElement("div",{className:"task-main"},r.createElement("div",{className:"task-main-left",onClick:()=>p(t.id),tabIndex:0,role:"button"},T&&r.createElement("div",{className:"expand-icon "+(C?"expanded":""),onClick:e=>{e.stopPropagation(),a(t.id)}},"▶"),r.createElement("div",{className:"task-checkbox "+(t.completed?"checked":""),onClick:e=>{e.stopPropagation(),c(t.id)}}),r.createElement("div",{className:"task-content"},r.createElement("div",{className:"task-id-wrapper"},r.createElement("span",{className:"task-id"},t.id),t.processing&&r.createElement("span",{className:"processing-badge"},"执行中"),t.linkCount>0&&r.createElement("span",{className:"link-status-icon "+(t.linkExists===t.linkCount?"link-complete":"link-partial"),title:`链接检查: ${t.linkExists}/${t.linkCount} 个链接存在`},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:14,height:14},r.createElement("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),r.createElement("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})),r.createElement("span",{className:"link-count"},`${t.linkExists}/${t.linkCount}`))),$?r.createElement("textarea",{ref:x,className:"task-title-edit",value:w,onChange:e=>{y(e.target.value)},onBlur:e=>((e,t)=>{const n=e.currentTarget.value.trim();n&&(u(t,n),f&&f(t))})(e,t.id),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),e.currentTarget.blur()),"Escape"===e.key&&(y(t.rawContent||t.title),d(taskId))},placeholder:"输入任务内容...",style:{height:E}}):r.createElement("div",{className:"task-title",dangerouslySetInnerHTML:R?void 0:{__html:(()=>{try{return fe.parse(t.title,{async:!1})}catch(e){return console.error("[Webview] Markdown渲染错误:",e),t.title.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}})()},onClick:e=>{m&&m(e,t.id)},style:{cursor:"pointer"}}))),r.createElement("div",{className:"task-actions"},r.createElement("button",{className:"action-btn "+(i[`${Le}_${t.id}`]?"disabled":""),disabled:i[`${Le}_${t.id}`],onClick:e=>{e.stopPropagation(),k(t.id)},title:"添加子任务"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:14,height:14},r.createElement("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.createElement("line",{x1:"5",y1:"12",x2:"19",y2:"12"}))),r.createElement("button",{className:"action-btn delete-btn "+(i[`${Be}_${t.id}`]?"disabled":""),disabled:i[`${Be}_${t.id}`],onClick:e=>{e.stopPropagation(),g(t.id)},title:"删除任务"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,width:14,height:14},r.createElement("polyline",{points:"3 6 5 6 21 6"}),r.createElement("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}),r.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),r.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}))),r.createElement("button",{className:"action-btn claude-btn "+(o[t.id]?"disabled":""),disabled:o[t.id],onClick:e=>{e.stopPropagation(),o[t.id]||h(t.id)},title:o[t.id]?"执行中...":"执行任务"},r.createElement("svg",{viewBox:"0 0 24 24",fill:"currentColor",stroke:"none",width:14,height:14},r.createElement("polygon",{points:"5 3 19 12 5 21 5 3"})))))),T&&r.createElement("ul",{className:"children "+(C?"":"collapsed"),style:z},t.children.map(e=>r.createElement(Ze,{key:e.id,task:e,depth:n+1,expandedTasks:s,editModes:l,buttonCooldown:i,onToggleExpand:a,onToggleComplete:c,onSelect:p,onToggleEdit:d,onSaveTitle:u,onClaudeExecute:h,onDelete:g,onAddSubTask:k,claudeExecuting:o,onDoubleClick:b,onSaveComplete:f,onTaskContentClick:m}))))};r.useState,r.useEffect,r.useCallback,r.useRef;let Qe=null;try{Qe=acquireVsCodeApi(),Qe?(void 0===window.MDTODO&&(window.MDTODO={}),window.MDTODO.vscodeApi=Qe,console.log("[Webview] VSCode API initialized successfully")):console.error("[Webview] acquireVsCodeApi returned null")}catch(e){console.error("[Webview] Failed to initialize VSCode API:",e)}let Ve=!1;window.MDTODO.setSaveCompleteCallback=e=>{Fe=e};let Fe=null,Ge=null,Ue=null;const Xe=e=>{Fe?Fe(e):(e=>{Ge=e,Ue&&clearTimeout(Ue),Ue=setTimeout(()=>{Fe&&Ge&&Fe(Ge),Ge=null,Ue=null},50)})(e)};window.MDTODO.refreshTaskTitle=(e,t)=>{Qe&&Qe.postMessage({type:"refreshTaskTitle",taskId:e,newTitle:t})},window.MDTODO.updateTaskState=null,(()=>{const e=document.getElementById("root");e&&!Ve&&((0,s.H)(e).render(r.createElement(r.StrictMode,null,r.createElement(He,{vscodeApi:Qe,onSaveComplete:Xe}))),setTimeout(()=>{Qe&&!Ve?(console.log("[Webview] Sending ready message"),Ve=!0,Qe.postMessage({type:"ready"})):Qe||console.error("[Webview] Cannot send ready: vscodeApi is null")},100))})(),MDTODO={}})();